# Story 1.1 Risk Profile — Coordinator Utilities (2025-09-30)

## Summary

Coordinator utilities now ship with deterministic unit coverage, runner integrations (Stories 1.2/1.3), and a synthetic end-to-end harness that exercises mixed-latency foreground/background tools. Abort handling and concurrency clamps have been validated in both utilities and runner contexts, and telemetry spans are live via the shared coordinator flow. Remaining exposure is limited to observing production telemetry trends as the feature flag is rolled out. Overall risk rating is **Low**.

## Overall Risk Score

- Base Score: 100
- Deductions: 1 × Low (−2), 1 × Low (−2)
- **Calculated Score:** 96 / 100 (Low)

## Risk Matrix

| Risk ID  | Description                                                                                              | Probability | Impact     | Score | Priority |
| -------- | -------------------------------------------------------------------------------------------------------- | ----------- | ---------- | ----- | -------- |
| TECH-001 | Scheduler races break ordered aggregation or duplicate hook emissions under parallel load.               | Low (1)     | Medium (2) | 2     | Low      |
| OPS-001  | Abort signal not propagated reliably, leaving hanging tool invocations and UI inconsistencies.           | Low (1)     | Medium (2) | 2     | Low      |
| PERF-001 | Misconfigured concurrency cap saturates provider rate limits, degrading wall-time and hitting throttles. | Low (1)     | Medium (2) | 2     | Low      |
| QA-001   | Missing deterministic unit tests produce flaky regressions in concurrency and abort scenarios.           | Low (1)     | Low (1)    | 1     | Low      |

## Detailed Risk Register

| Risk ID  | Category          | Affected Components                                                | Detection Method                                                          | Mitigation Strategy                                                                                                         | Owner           | Status     |
| -------- | ----------------- | ------------------------------------------------------------------ | ------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------- | --------------- | ---------- |
| TECH-001 | Technical         | `executeToolCallsInParallel`, hooks, downstream result aggregation | Unit + E2E harness (`parallelCoordinator.e2e.test.ts`) verifying ordering | Maintain E2E harness and runner integrations; monitor telemetry for unexpected marker skew post-release.                    | Dev Agent       | Mitigated  |
| OPS-001  | Operational       | Abort handling, hook cleanup, telemetry spans                      | Unit tests + runner integration suites (`parallelExecution.test.ts`)      | Shared abort guards and listener cleanup validated; retain regression suite during flag rollouts.                           | Dev Agent       | Mitigated  |
| PERF-001 | Performance       | Concurrency cap configuration, feature flag defaults               | Config clamp tests (`parallelConfig.test.ts`) + telemetry summary logs    | Defaults clamp inputs 1..10; telemetry summary to be watched during rollout with alerting if duration variance exceeds 10%. | Dev Agent & Ops | Monitoring |
| QA-001   | Quality Assurance | Coordinator test coverage                                          | Deterministic unit suite + E2E harness execution record                   | Maintain helper utilities for fake timers and periodically rerun harness with real timers to catch environment regressions. | QA + Dev        | Closed     |

## Risk-Based Testing Strategy

1. **Low (TECH-001, OPS-001)**
   - Keep E2E harness (`parallelCoordinator.e2e.test.ts`) in regression plan and extend chaos coverage as feature flag widens.
   - Continue sampling telemetry spans for marker/abort anomalies after deployment.
2. **Low (PERF-001)**
   - Track concurrency configuration changes through summary logs and alert on sustained wall-time regressions.
3. **Low (QA-001)**
   - Periodically rerun suites with real timers to validate no environment-specific regressions emerge.

## Deployment & Monitoring Recommendations

- Maintain observability dashboards for latency, concurrency, and abort metrics; alert on >10% variance week-over-week.
- Document manual rollback toggle in runbook for on-call engineers (already in place).
- Capture results of staged rollout and feed back into QA risk review if anomalies surface.

## Quality Gate Recommendation

- **Gate Status:** PASS — Evidence collected via unit, integration, and E2E harnesses plus runner integrations.
- **Next Review Trigger:** Revisit if telemetry signals regressions during staged rollout.
